FROM node:hydrogen-alpine

WORKDIR /ui

COPY . .

RUN npm i

ARG PROPEL_AUTH_URL
ARG PROPEL_AUTH_KEY

RUN NEXT_PUBLIC_PROPEL_AUTH_URL=$PROPEL_AUTH_URL NEXT_PUBLIC_AUTH_KEY=$PROPEL_AUTH_KEY npm run build

ENTRYPOINT [ "npm", "run", "start" ]